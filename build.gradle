apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'eclipse'

mainClassName = 'ui.LwrtGUI'

sourceSets {
    main {
        resources {
            exclude '**/*.db'
        }
    }
}

jar {
    archiveName = 'lawena.jar'
    destinationDir = null
    manifest {
        new ByteArrayOutputStream().withStream { execOS ->
            def result = exec {
                executable = 'git'
                args = [ 'describe', '--tags' ]
                standardOutput = execOS
            }
            def buildVersion = execOS.toString().trim()
            version buildVersion
        }
        
        ext.buildTime = new Date().format("yyyyMMddHHmmss")
        file('version.txt').write ext.buildTime
        
        attributes (
            'Main-Class': mainClassName,
            'Implementation-Title': 'lawena Recording Tool',
            'Implementation-Version': version,
            'Implementation-Build': ext.buildTime 
        )
    }
}
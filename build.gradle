apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'eclipse'

mainClassName = 'ui.LwrtGUI'

sourceSets {
    main {
        resources {
            exclude '**/*.db'
        }
    }
}

repositories {
    mavenCentral()
}

dependencies {
    compile 'com.google.code.gson:gson:2.2.4'
    compile 'org.swinglabs.swingx:swingx-core:1.6.5-1'
    compile 'org.swinglabs.swingx:swingx-autocomplete:1.6.5-1'
    compile 'org.swinglabs.swingx:swingx-common:1.6.5-1'
    compile 'org.swinglabs.swingx:swingx-action:1.6.5-1'
    compile 'org.swinglabs.swingx:swingx-plaf:1.6.5-1'
    compile 'org.swinglabs.swingx:swingx-graphics:1.6.5-1'
    compile 'org.swinglabs.swingx:swingx-painters:1.6.5-1'
    testCompile 'junit:junit:4.10'
}

test {
    testLogging.showStandardStreams = true
}

new ByteArrayOutputStream().withStream { execOS ->
    exec {
        executable = 'git'
        args = [ 'describe', '--tags', '--always' ]
        standardOutput = execOS
    }
    def buildVersion = execOS.toString().trim()
    version buildVersion
}

jar {
    archiveName = 'lawena.jar'
    destinationDir = null
    manifest {
        ext.buildTime = new Date().format("yyyyMMddHHmmss")
        file('version.txt').write ext.buildTime
        
        attributes (
            'Main-Class': mainClassName,
            'Implementation-Title': 'lawena Recording Tool',
            'Implementation-Version': version,
            'Implementation-Build': ext.buildTime,
            'SplashScreen-Image': 'ui/splash.png'
        )
    }
}